# A quick take on minica

Minica creates a Root CA and the requested leaf certificates easily with a single command.

Normally, you would have to go through this sequence with `openssl`:

1. generate a private key for the root CA
2. generate a root certificate using the previous private key
3. generate a private key for each new leaf certificate
4. generate a CSR (Certificate Signing Request)
5. configure eventual extension files for the signing process
6. generate a leaf certificate from the CSR, signed with the CA private key

The article *[Create Your Own SSL Certificate Authority for Local HTTPS Development](https://deliciousbrains.com/ssl-certificate-authority-for-local-https-development/)* describes each step and also how to import your Root CA into your system's trust store.

There are two small projects to simplify this and remove the necessary steps:

- `mkcert`: creates a root CA, imports the CA on system trust store and creates leaf certificates,
- `minica`: creates a default root CA and leaf certificates.

The focus here is on [minica](https://github.com/jsha/minica).

## Principles

Zero configuration is good configuration. Minica has an opinionated view and really few options:

- Root CA identity is not configurable: always named `minica root ca xxxxxx`,
- Certificates TTL is not configurable (2 years and 30 days),
- a folder is automatically created for each leaf certificate.

## Usage

To generate a certificate with a single subject name:

```bash
minica -domains hashibook.local
```

If the root CA is not present, it will be created. If present, it will be reused. Below is an example of file directory structure after running the previous command.

```bash
❯ tree .
.
├── hashibook.local
│   ├── cert.pem
│   └── key.pem
├── minica-key.pem
└── minica.pem

2 directories, 5 files
```

`minica-key.pem` and `minica.pem` are default filenames for the autogenerated Root CA. To give the root CA files a custom name, `-ca-cert` and `-ca-key` command line switches need to be used.

## Conclusion

That's it. Minica takes the error-prone 6 steps process down to one step, but it is all what it does. From there, you have to update your system's trust store and distribute your certificates where they are needed.

It is probably a good way to build a Vault PKI as an Intermediate CA and Minica as an external/offline Root CA.

## Further reading

- [What is a PEM file](https://serverfault.com/questions/9708/what-is-a-pem-file-and-how-does-it-differ-from-other-openssl-generated-key-file) on ServerFault, describing frequent PKI-related file formats usage and sorting out the jargon
- [OpenSSL Certificate Authority](https://jamielinux.com/docs/openssl-certificate-authority/index.html), an excellent step-by-step to become your own CA while following recommended security practices
